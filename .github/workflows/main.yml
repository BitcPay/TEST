# File: .github/workflows/rdp-simple.yml
name: RDP Setup (Simple)
on: [workflow_dispatch]

jobs:
  setup-rdp:
    runs-on: windows-latest
    timeout-minutes: 60  # Keep it short for testing
    
    steps:
    - name: Enable RDP
      run: |
        echo "Step 1: Enabling RDP..."
        reg add "HKLM\System\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
        echo "RDP enabled"
    
    - name: Open Firewall
      run: |
        echo "Step 2: Opening firewall..."
        netsh advfirewall firewall add rule name="RDP" dir=in action=allow protocol=TCP localport=3389
        echo "Firewall configured"
    
    - name: Start Service
      run: |
        echo "Step 3: Starting RDP service..."
        Start-Service TermService
        echo "Service started"
    
    - name: Show Info
      run: |
        echo "========================================"
        echo "RDP IS READY!"
        echo "Port: 3389"
        echo "========================================"
        echo "Note: This is local RDP only"
        echo "For Tailscale, add it separately"
        echo "========================================"
